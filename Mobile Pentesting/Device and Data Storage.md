### Data Storage

The Storage is broken into 2 major storage areas
- Internal Storage
- External Storage

### Internal Storage
All apps are installed in internal storage by default in a directory not accessible by other apps
**Apps are installed in internal storage** by default. but it can be configured.
- Installed apps go to:  
    üìÅ `/data/app/<package-name>/`
- Only the **app itself** can access its directory.
- This is enforced by **Linux file permissions** using **UID isolation**:
    - Every app runs under a unique **User ID (UID)**.
    - App A cannot access App B‚Äôs data, even though both may use internal storage.
##### Security Insight:

- **Prevents data leakage** between apps.
- But if the device is **rooted**, a malicious app or user could **bypass UID isolation** and read all app data.
- Pentesters with root access can examine `/data/app` to locate app APKs and `/data/data/<package>/` to inspect stored data.

##### Image 2: System App Installation Locations

- System apps are stored in:
    - üìÅ `/system/app/`
    - üìÅ `/system/priv-app/` (for sensitive or privileged apps)
- These directories are **read-only**, even to most apps, unless:
    - The device is **rooted**
    - You are using an **emulator** with full permissions
##### Security Insight:
- Apps in `/system/priv-app/` can have **additional permissions** not available to normal apps (like SMS or call logs access).
- **Privileged escalation** can happen if a non-system app is wrongly placed in this folder.
- Pentesters examine these locations to identify potential **backdoors** or **OEM-added apps** that weaken security.
    
##### **Image 3: Internal Storage File Access Modes**
Apps can store files in internal storage with different access modes

|Mode|Meaning|
|---|---|
|`MODE_PRIVATE`|(Default) Only the app can access the file|
|`MODE_WORLD_READABLE`|Any app can read the file|
|`MODE_WORLD_WRITEABLE`|Any app can modify the file|
|`MODE_APPEND`|Data is appended to the file rather than overwritten|

### External Storage
Files created on¬†[external storage](https://developer.android.com/guide/topics/data/data-storage#filesExternal), such as SD cards, are globally readable and writable. Because external storage can be removed by the user and also modified by any application, only store non-sensitive information using external storage. external storage usually located in /sdcard or /mnt/sdcard.

[Perform input validation](https://developer.android.com/privacy-and-security/security-tips#input-validation)¬†when handling data from external storage as you would with data from any untrusted source. Don't store executables or class files on external storage prior to dynamic loading. If your app does retrieve executable files from external storage, make sure the files are signed and cryptographically verified prior to dynamic loading.

### Device Administration API

The **Device Administration API** is a legacy Android API that allows developers to create applications that can enforce **security and policy management** on Android devices at the **device level**, such as password rules, screen lock, camera control, and remote wipe functionality. It is primarily used in enterprise and mobile device management (MDM) contexts.

The **Device Administration API** allows apps to **enforce security policies** on a device. When an app is registered as a **device administrator**, it is granted elevated privileges by the Android system, which can be used to:

- Control password policies
- Lock or wipe the device remotely
- Disable the camera
- Enforce encryption
- Prevent app uninstallation
This is typically used by organizations to **manage employee devices**.

### Mobile Device Management
**Mobile Device Management (MDM)** software is a solution used by organizations to **secure, monitor, and manage mobile devices** (smartphones, tablets, laptops) used by employees or within the organization‚Äîespecially in **enterprise** or **corporate environments**.

## üìå Definition

**Mobile Device Management (MDM)** refers to a **suite of tools and technologies** that allows IT administrators to:

- Configure and control mobile devices remotely
- Enforce security policies
- Distribute apps and updates
- Monitor compliance and device usage
- Protect company data on both corporate-owned and BYOD (Bring Your Own Device) devices
    


#### Why MDM Is Used

### 1. **Security Enforcement**

- Set password complexity rules
- Encrypt device storage
- Remotely wipe lost or stolen devices
- Disable certain apps or features (e.g., camera, USB, screenshots)
### 2. **Device Inventory and Monitoring**

- View device status and health
- Track device location (for corporate-owned devices)
- Detect rooted or jailbroken devices
### 3. **Remote Management**

- Configure Wi-Fi, VPN, and email settings
- Push security patches or OS updates
- Lock or reset devices
- Install/uninstall enterprise apps
### 4. **Data Protection and Compliance**

- Prevent data leakage by disabling copy-paste or file sharing
- Enforce separation of personal and work data (via Work Profiles or containers)
- Ensure compliance with regulatory standards (e.g., HIPAA, GDPR)
### 5. **Application Management**

- Distribute and update internal business apps
- Whitelist/blacklist apps
- Prevent sideloading or unauthorized installations

## Who Uses MDM?

- **Enterprises** managing hundreds or thousands of employee devices
- **Educational institutions** managing student tablets/laptops
- **Healthcare** and **finance** sectors with strict data compliance requirements
- **Government agencies** managing remote or field staff devices
- **Retail and logistics** managing kiosk devices or delivery team tablets
[Read More](https://www.kandji.io/definitions/what-is-mobile-device-management-mdm/)

### Third Party Code

#### SDK
A **Software Development Kit (SDK)** is a set of software tools and resources provided by hardware or software vendors to help developers create applications tailored to a specific platform, device, or service.

When you're analyzing a mobile app (for security or functionality), it's **not enough to just look at the app code**. You must also examine **any third-party SDKs** the app uses.

- SDKs often add new features (e.g., ads, analytics, cloud sync).
- But they can also bring **security risks**, especially if they're outdated, misused, or come from untrusted sources.
When you're performing **mobile app pentesting** or **static analysis (like reversing APKs)**:

- You **check which SDKs** are included (using tools like MobSF, jadx, or manual inspection).
- Then you **research those SDKs**: Are they known to have security issues? Are they leaking data? Are they using outdated encryption?
- You report these risks, even if the core app code is secure.

#### Third Party Libraries 
A **third-party library** is external code that developers include in their apps to add features like networking, encryption, analytics, UI components, or database access.
##### Importance of Managing Third-Party Libraries

- It is crucial for organizations and testers to track which third-party libraries are included in their applications.
- Libraries may introduce additional features, but they can also bring vulnerabilities if not properly maintained.
- Developers should monitor the security status of these libraries by:
    - Subscribing to mailing lists.
    - Following bug trackers and project repositories (e.g., GitHub).
    - Staying informed about newly discovered issues.
##### Security Testing and Third-Party Libraries

- When testing mobile applications, it is important to create a full inventory of all third-party libraries used.
- At a minimum, testers should:
    - Conduct an internet search on each library to identify any known vulnerabilities or CVEs (Common Vulnerabilities and Exposures).
    - Review the library‚Äôs update history and developer activity.


### Device Tracking
- Some developers attempt to **track users persistently**, even if the user uninstalls and reinstalls the app.
- They do this by using **permanent hardware identifiers**, which are values tied to the physical hardware of the device.
- These identifiers **do not change** even when the device is reset, or the app is removed, making them useful for **long-term user tracking**.
#### Common Hardware Identifiers Used for Tracking

|Identifier|Description|
|---|---|
|**MAC Address**|A unique identifier assigned to the device‚Äôs network interface (Wi-Fi, etc.).|
|**IMEI**|International Mobile Equipment Identity ‚Äì a unique number for GSM devices.|
|**ESN**|Electronic Serial Number ‚Äì used in older CDMA phones.|
|**MEID**|Mobile Equipment Identifier ‚Äì similar to IMEI but used in CDMA networks.|
|**IMSI**|International Mobile Subscriber Identity ‚Äì stored on the SIM card.|
|**Serial Number**|The manufacturer‚Äôs unique number assigned to the hardware.|
|**Android ID**|A persistent ID assigned by Android during the first boot.|

### Tapjacking
**Tapjacking** (short for "tap hijacking") is a type of **UI redressing attack** on Android devices. It tricks a user into tapping on something they **can‚Äôt see** by placing a transparent or misleading overlay on top of a legitimate interface.

Think of it like putting a transparent piece of paper with a fake "Play" button over a real one. The user thinks they‚Äôre tapping the fake button, but they‚Äôre actually interacting with the underlying (and potentially dangerous) app.

#### How Does Tapjacking Work?

1. **Malicious app creates a transparent overlay** using features like `Toast`, `AlertWindow`, or `SYSTEM_ALERT_WINDOW`.
2. The overlay is positioned over a legitimate UI element ‚Äî for example, the ‚ÄúInstall‚Äù or ‚ÄúAllow‚Äù button in the Play Store or a permission dialog.
3. The user taps what they _think_ is a harmless part of the UI, but they're actually triggering hidden actions underneath.

[Read more](https://redfoxsec.com/blog/android-tapjacking-vulnerability/)
[Read more](https://valsamaras.medium.com/tapjacking-attacks-a-thorough-guide-2cd6486d0fc9)
