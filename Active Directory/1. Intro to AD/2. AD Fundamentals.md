## Forest
A **forest** is the **topmost logical container** in Active Directory and can contain **one or more domains**.
- All domains in a forest share:
    - A **common schema**
    - A **configuration**
    - A **global catalog**

- Domains within a forest **trust each other by default**, allowing users to access resources across domains without needing manual trust setups.

## Domain

A **domain** in Active Directory is like a **private space or container** that holds objects such as **users, computers, and groups**. Each domain:

- Has its own set of **configurations**, **security policies**, and **administrative control**.
- Has its own set of **administrators** who manage the objects within it.



## Realm 
A realm is a Kerberos authentication boundary that defines where user and service credentials are stored and validated. Each Active Directory domain functions as a Kerberos realm, and realms are primarily used when Active Directory interoperates with non-Windows Kerberos systems.

```
Active Directory domain: example.com
Corresponding Kerberos realm: EXAMPLE.COM
```

## Organizational Units (OUs)

**Organizational Units (OUs)** are **containers within a domain** that organize and manage objects like users, groups, and computers. Key points:

- Help group objects logically (e.g., by **department**, **location**, or **role**).
- Allow **separate Group Policy Objects (GPOs)** to be applied for **granular control**.


## Active Directory Terminology

###  Object

An **object** is a distinct entity in AD, such as a **user**, **computer**, or **group**.

###  Attributes

Each object has **attributes** (properties). For example:

|**Object Type**|**Attribute**|**Description**|
|---|---|---|
|**User**|name|Full name of the user|
||email|User's email address|
||phone number|User's phone number|
||group memberships|Groups the user belongs to|
||password|(Stored as hashed)|
|**Computer**|hostname|Device name|
||operating system|Installed OS|
||IP address|Assigned IP|
|**Group**|group name|Name of the group|
||group type|Security or Distribution|
||group members|List of members|

## 1. **User Account**
Represents a **human user** in Active Directory  used for logging into systems and accessing resources.
###  **Identification:**

- `objectClass`: `user`
- `sAMAccountType`: `0x30000000`
- `sAMAccountName`: **does not end with `$`**
- `userAccountControl`: typically `512` (UF_NORMAL_ACCOUNT)

## 2. **Computer Account**
Represents a **domain-joined computer**  used for machine authentication and policy application.
###  **Identification:**

- `objectClass`: `computer`
- `sAMAccountType`: `0x30000001`
- `sAMAccountName`: **ends with `$`** (e.g., `WIN10-PC$`)
- `userAccountControl`: `4096` (UF_WORKSTATION_TRUST_ACCOUNT)

##  3. **Service Account**
A **user account** intended to run services or applications not meant for human interaction.
###  **Identification:**

- `objectClass`: `user`
- **sAMAccountName** often includes `svc`, `service`, or `app`
- May have `ServicePrincipalName` set (SPN)
- `userAccountControl`: often includes `DONT_EXPIRE_PASSWORD`
- Interactive login typically **disabled**


### GUID (Global Unique Identifier)
<p align="justify">`Global Unique Identifier`  is a unique 128-bit value assigned when a domain user or group is created. This GUID value is unique across the enterprise, similar to a MAC address. Every single object created by Active Directory is assigned a GUID, not only user and group objects. The GUID is stored in the `ObjectGUID` attribute</p>

- A **128-bit unique value** assigned to each object (users, computers, groups, etc.).
- Stored in the `ObjectGUID` attribute.

###  Security Principal

An entity (user, group, computer, service) that can be **authenticated** and **authorized** in AD.


## Foreign Security Principal
When domains establish trust relationships (such as forest or external trusts), security principals (users, groups, or computers) from one domain can be referenced in another. A Foreign Security Principal (FSP) is an Active Directory object that represents a security principal from a trusted external domain or forest within the local domain.

An FSP acts as a placeholder that allows external principals to be:
- Added to domain local security groups
- Assigned permissions on resources through ACLs
- Included in Group Policy filtering

Only the Security Identifier (SID) of the external principal is stored in the Foreign Security Principals container. The actual identity (name, group membership, etc.) is resolved dynamically through the existing trust relationship with the foreign domain.

### SID (Security Identifier)

- Unique identifier used to manage **security permissions**.
- Every security principal has a SID.

#### Well-known SIDs:

|**SID**|**Name**|**Description**|
|---|---|---|
|S-1-0-0|Nobody|No security principal|
|S-1-1-0|Everyone|All users, including anonymous|
|S-1-5-11|Authenticated Users|Authenticated identities|
|S-1-5-18|Local System|Operating system service account|
|S-1-5-21domain-512|Domain Admins|Domain administrators|
|S-1-5-32-544|Administrators|Full system control|
|S-1-5-32-545|Users|Authenticated users|
|S-1-5-32-546|Guests|Limited privileges|
|S-1-5-32-551|Backup Operators|Can backup/restore all files|

## Relative Identifier
A **RID** is the last part of a **Security Identifier (SID)** in Windows, used to uniquely identify a user, group, or computer **within a domain**.Each object in a domain shares the same domain SID prefix, and the **RID** differentiates them.

| Part      | Meaning                                       |
| --------- | --------------------------------------------- |
| S-1-5     | Standard SID prefix                           |
| 21-123... | Domain ID (same for all users in that domain) |
| **500**   | ← This is the **RID**                         |
#### Common RIDs:

| RID   | Who it belongs to     |
| ----- | --------------------- |
| 500   | Administrator account |
| 501   | Guest account         |
| 512   | Domain Admins group   |
| 1000+ | Normal user accounts  |


###  sAMAccountName

The **logon username** used within a domain for authentication.


###  Read-Only Domain Controller (RODC)

- A **read-only** copy of the domain controller.
- Used in **less secure** or **remote** environments.
- Supports **authentication** but **no write operations**.

###  SPN (Service Principal Name)

A unique name identifying an instance of a service, used for **Kerberos authentication**.
An **SPN (Service Principal Name)** is a **unique identifier** for a service instance in Active Directory. It maps a service instance to a service logon account, allowing **Kerberos authentication** to locate and authenticate services.

### GPO (Group Policy Object)

A set of **rules and settings** that define behavior for users and computers.
- Used to enforce security, configurations, software installations, etc.

###  ACE & SACL

- **Access Control Entry (ACE)**: Defines individual user/group permissions in an **Access Control List (ACL)**.
- **System Access Control List (SACL)**: Logs **access attempts** (successful or failed) for auditing purposes.

###  Tombstone

Tombstone is a container object in AD that holds deleted AD objects. When an object is deleted and the Recycle Bin is not enabled, the object enters the **Tombstone state** as a part of Active Directory’s internal process for marking deleted objects. When an object is deleted from AD, the object remains for a set period of time known as the `Tombstone Lifetime,` and the `isDeleted` attribute is set to `TRUE`. Once an object exceeds the `Tombstone Lifetime`, it will be entirely removed.

- A **deleted object placeholder** in AD.
- Objects remain in **tombstoned** state for a **defined lifetime** before full deletion.
- Attribute `isDeleted = TRUE`.
###  Active Directory Recycle Bin
 It is a feature that allows for the recovery of deleted AD objects, such as users, groups, and organizational units, without requiring a system restore. When an object is deleted, it enters a "soft delete" state where its data is preserved, and it can be restored with all its attributes, including group memberships and passwords 

- Allows recovery of deleted AD objects with **attributes and group memberships preserved**.
- Must be **enabled manually**.
- Default retention: **180 days**.
### SYSVOL

- Contains public AD files like **Group Policy**, **scripts**, etc.
- Replicated across domain controllers via **FRS** or **DFSR**.
###  AdminCount

Indicates whether an object is a **protected privileged account**.

- `adminCount = 1` → Protected (e.g., Domain Admins)
- `adminCount = 0` or not set → Unprotected
- Controlled by **SDProp** (Security Descriptor Propagation)
### NTDS.DIT 

It is a critical database file in Active Directory, stored on every **Domain Controller** (DC) in the `C:\Windows\NTDS\` directory. It contains all the essential information about the Active Directory environment, including:

	- **User and group objects** (like user accounts and groups)
	- **Group membership**
	- **Password hashes** for all users in the domain (this is particularly important to attackers)



## Global Catalog
A **Global Catalog Server** is a Domain Controller that holds a **partial replica of all objects in the forest**, allowing users and applications to **locate resources and authenticate across multiple domains**.

A DC in an Active Directory (AD) network stores full information only related to the domain it is in. To locate objects outside its domain is beyond its scope. Hence, there is a need for a server called a global catalog server. The global catalog contains a partial representation of all objects in the entire forest. Hence, a global catalog server has the potential to search objects from any domain within the forest it is in.

### MachineAccountQuota

**`MachineAccountQuota` (MAQ)** is an **Active Directory domain attribute** that controls **how many computer accounts a non-privileged (domain) user is allowed to create** in the domain.

