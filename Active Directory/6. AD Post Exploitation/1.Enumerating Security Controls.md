This is done after gaining a initial foothold of the machine. The best bet is to enumerate the defensive state of the machine

### Windows Defender
- This command will give us the windows defender status 
- If RealTimeProtectionEnabled parameter is set to `TRUE`which means Defender is enabled on the system
```
Get-MpComputerStatus
```

### AppLocker
AppLocker is Microsoft's application whitelisting solution and gives system administrators control over which applications and files users can run. It provides granular control over executables, scripts, Windows installer files, DLLs, packaged apps, and packed app installers.

- Most orgs block cmd.exe and powershell.exe but this can all be bypassed. Organizations also often focus on blocking the PowerShell.exe executable, but forget about the other PowerShell executable locations such as`%SystemRoot%\SysWOW64\WindowsPowerShell\v1.0\powershell.exe` or `PowerShell_ISE.exe`

- Gives the App locker details
```
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
```

### PowerShell Constrained Language Mode
<p align="justify">PowerShell Constrained Language is aÂ language mode of PowerShell designed to support day-to-day administrative tasks, yet restrict access to sensitive language elements that can be used to invoke arbitrary Windows APIs.</p>
- You can check whether you are in **Constrained Language Mode** or not  by running
```
$ExecutionContext.SessionState.LanguageMode
```


### LAPS
<p align="justify">LAPS (Local Administrator Password Solution) is a Microsoft security feature designed to manage and secure local administrator passwords on domain-joined computers. It ensures that each machine has a unique, randomized, and regularly updated local administrator password, reducing the risk of lateral movement in an Active Directory (AD) environment.</p>
- Checking if LAPS is installed on system or not
```
Get-Module -ListAvailable | Where-Object { $_.Name -like "AdmPwd*" }
```

- LAPS restricts access to local administrator passwords. Check **who can read** these passwords. This will list **Organizational Units (OUs)** where LAPS is enabled and **who has access**.
```
Find-LAPSDelegatedGroups
```

- This checks which users have the **"All Extended Rights"** permission, which allows them to **read LAPS passwords**.
```
Find-AdmPwdExtendedRights
```

- This will list computers with LAPS enabled
```
Get-LAPSComputers
```

### Snaffler
<p align="justify">Snaffler is a Windows tool used by penetration testers and red teamers to search for sensitive files on network shares in Active Directory environments. It automates the process of  finding exposed passwords, API keys, configuration files, and other valuable information that users may have stored in shared folders.</p>

```
.\Snaffler.exe --help
```

```
Snaffler.exe -s -o snaffler_output.log -d <domain_name> -c <DC_IP>
```
