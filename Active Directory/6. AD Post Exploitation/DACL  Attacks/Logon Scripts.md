A **logon script** in Active Directory is a script that **automatically runs** when a domain user **logs into a Windows system** that's part of the AD domain.

It is used to **automate tasks** like:
- Mapping network drives
- Connecting printers
- Setting environment variables
- Running security checks
- Launching applications

Logon scripts can be assigned in two main ways:

### 1. **User’s `scriptPath` Attribute (Legacy Method):**

- Set manually in **Active Directory Users and Computers (ADUC)**:
    
    - Go to **User Properties > Profile Tab > Logon Script**
        
- This sets the `scriptPath` attribute in AD
    
- Script must be placed in:  
    `\\<domain>\NETLOGON`  
    (Physically stored in: `C:\Windows\SYSVOL\sysvol\<domain>\scripts\`)
    

### 2. **Group Policy (Modern Method):**

- Set via **GPO**:  
    `User Configuration > Windows Settings > Scripts (Logon/Logoff) > Logon`
    
- Script is stored in:  
    `\\<domain>\SYSVOL\<domain>\Policies\{GUID}\User\Scripts\Logon`
## Script Types Supported

| Assignment Method         | Supported File Types                                            |
| ------------------------- | --------------------------------------------------------------- |
| **scriptPath (Legacy)**   | `.bat`, `.cmd`, `.vbs`, `.js`, `.exe` — NOT PowerShell directly |
| **Group Policy (Modern)** | All above **plus PowerShell** scripts (`.ps1`) ✅                |
### Attack Vectors
- Write ScriptPath 
- ReadScriptPath

### Enumeration from Linux
- pyviewer
- dacledit.py
- Adalanche - GUI Support

### Abusing Logon Script 
After Determining a user has write and read perms over the scripts path. we will attempt to exploit this DACL misconfiguration from Linux to gain a reverse shell

1. Enumerate the NETLOGON share to determine whether attacker  has over eric , write permissions anywhere within it.
	- smbclient
	- smbcacls
2. if attacker does have write permissions, create in runs a PowerShell reverse shell one-liner
3. Update  scriptPath to be the same path as the payload file we placed in Step2
	- ldapmodify 
	 - bloodyAD
4. Wait until eric logs onto the domain to receive the reverse shell