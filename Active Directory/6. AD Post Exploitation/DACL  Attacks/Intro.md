### What is ACL
<p align="justify">An access control list (ACL) is a list of rules that specifies which users or systems are granted or denied access to a particular object or system resource.</p>

An **Access Control Entry (ACE)** is a single line or rule **within** an Access Control List (ACL) that specifies the **permissions** for a particular **user or group** on a **resource or object**.

#### Types of Access Control List
- Discretionary Access Control List (DACL)

	A list that defines **which users or groups are allowed or denied access** to a securable object (like a file or AD object). It is created and managed by the object‚Äôs owner

- System Access Control List (SACL)

	A list that specifies **which access attempts should be logged** in the system‚Äôs security audit log. Used for auditing access to objects.

### What is Access Control Policy
An **access control policy** is a formal set of rules that defines **who is allowed to access specific resources**, **what actions they are permitted to perform**, and **under what conditions** access is granted or denied.

#### Types of Access Control Policy
- Discretionary Access Control (DAC)
	A policy where the **owner of a resource** decides who can access it and what permissions they have.

-  Mandatory Access Control (MAC)
	A policy enforced by the **system**, where access decisions are based on **security labels** and **clearance levels**, not user choice.

 - Role-Based Access Control (RBAC)
	A policy where access is granted based on the **user's role** within an organization, and permissions are assigned to roles, not individuals.

- Attribute-Based Access Control (ABAC)
	A policy where access decisions are made based on **user, resource, and environment attributes**, using rules to evaluate conditions.


### What is Security Descriptors
<p align="justify">A¬†security descriptor is a data structure that  contains the security information associated with a¬†object. Every Object has a security descriptor data structure that specifies who can perform what actions on the object.</p>

##### Types of Security Descriptors
- Absolute Security Descriptors
	contain pointers to the information (i.e., not the actual information itself),  and these are the ones that we will encounter when interacting with Windows objects, whether AD ones or not
	
- Self-relative security descriptors 
	These are not very different: instead of storing pointers, they store the actual data of a security descriptor in a contiguous memory block. These are meant to store a security descriptor on a disk or transmit it over the wire.
##### Main Components of a Security Descriptor

| **Field**         | **Description**                                                           |
| ----------------- | ------------------------------------------------------------------------- |
| `Revision Number` | Indicates the version of the Security Reference Monitor (SRM)             |
| `Control Flags`   | Bit flags that define behavior (e.g., inheritance, presence of DACL/SACL) |
| `Owner SID`       | SID of the object's owner; has implicit full control                      |
| `Group SID`       | SID of the object's primary group (mostly unused now)                     |
| `DACL`            | **Discretionary Access Control List** ‚Äî defines **who can do what**       |
| `SACL`            | **System Access Control List** ‚Äî defines **what actions are audited**     |

#### Control
The `**Control**` field is a **16-bit value** made up of **bit flags** from the `SECURITY_DESCRIPTOR_CONTROL` enum. These flags **define how the security descriptor behaves**, especially in relation to the presence and inheritance of DACLs and SACLs.

### **Common Flags in `SECURITY_DESCRIPTOR_CONTROL`**

|**Flag**|**Hex Value**|**Description**|
|---|---|---|
|`SE_DACL_PRESENT`|`0x0004`|A DACL is present. If this flag is missing or the DACL is NULL ‚Üí full access to everyone. An **empty DACL** ‚Üí access to no one.|
|`SE_DACL_DEFAULTED`|`0x0008`|DACL was provided by default, not explicitly set.|
|`SE_DACL_PROTECTED`|`0x1000`|Prevents inheritance of parent DACLs.|
|`SE_DACL_AUTO_INHERIT_REQ`|`0x0100`|Requests that the object's DACL be automatically inherited by child objects.|
|`SE_DACL_AUTO_INHERITED`|`0x0400`|Indicates the DACL was inherited from the parent.|

---

|**SACL Flags**|**Hex Value**|**Description**|
|---|---|---|
|`SE_SACL_PRESENT`|`0x0010`|A SACL is present (used for auditing).|
|`SE_SACL_DEFAULTED`|`0x0008`|SACL was provided by default.|
|`SE_SACL_PROTECTED`|`0x2000`|Prevents inheritance of parent SACLs.|
|`SE_SACL_AUTO_INHERIT_REQ`|`0x0200`|Requests auto-inheritance of SACL by children.|
|`SE_SACL_AUTO_INHERITED`|`0x0800`|Indicates the SACL was inherited.|

---

| **Other Flags**      | **Hex Value** | **Description**                                                                      |
| -------------------- | ------------- | ------------------------------------------------------------------------------------ |
| `SE_SELF_RELATIVE`   | `0x8000`      | Indicates the descriptor is in self-relative format (used for storage/transmission). |
| `SE_OWNER_DEFAULTED` | `0x0001`      | Owner SID was set by default, not explicitly.                                        |
| `SE_GROUP_DEFAULTED` | `0x0002`      | Group SID was set by default.                                                        |


### What is an Access Mask
An **Access Mask** is a **32-bit binary value** that defines what **permissions or rights** a user, group, or security principal has over a specific **securable object** in Windows (like a file, folder, registry key, AD object, etc.).Think of it as a **bitmask**‚Äîeach bit represents a different permission. The bits can be combined (using OR operations) to represent multiple permissions at once.

`Format`

```
  31        24 23        16 15         8 7          0
+------------+------------+------------+------------+
| Generic    | Special    | Standard   | Specific   |
| Rights     | Rights     | Rights     | Rights     |
+------------+------------+------------+------------+
```

### What is Access Rights
**Access Rights** define the **specific actions** a user, group, or process (called a **principal**) is allowed (or denied) to perform on a **securable object**‚Äîsuch as a file, folder, registry key, or Active Directory object.They are enforced through **Access Control Entries (ACEs)** inside a **Discretionary Access Control List (DACL)**, which is part of a **Security Descriptor**.


## üß© Generic Access Rights

| Display Name   | Common Name             | Hex Value     | Interpretation                                                                 |
|----------------|--------------------------|---------------|--------------------------------------------------------------------------------|
| GenericAll     | RIGHT_GENERIC_ALL        | `0x10000000`  | Full control: create/delete child objects, modify properties, manage access    |
| GenericExecute | RIGHT_GENERIC_EXECUTE    | `0x20000000`  | List contents, read permissions                                                |
| GenericRead    | RIGHT_GENERIC_READ       | `0x80000000`  | Read object data and attributes                                                |
| GenericWrite   | RIGHT_GENERIC_WRITE      | `0x40000000`  | Modify object data and attributes                                              |

## üõ†Ô∏è Standard Access Rights

| Display Name  | Common Name         | Hex Value     | Interpretation                                                               |
|---------------|---------------------|---------------|-------------------------------------------------------------------------------|
| Delete        | RIGHT_DELETE        | `0x00010000`  | Delete the object                                                             |
| ReadControl   | RIGHT_READ_CONTROL  | `0x00020000`  | Read security descriptor (excluding SACL)                                     |
| WriteDACL     | RIGHT_WRITE_DAC     | `0x00040000`  | Modify the DACL (permissions)                                                 |
| WriteOwner    | RIGHT_WRITE_OWNER   | `0x00080000`  | Take ownership of the object                                                  |
| Synchronize   | SYNCHRONIZE         | `0x00100000`  | Used in object synchronization (non-AD specific)                              |

## üß¨ Object-Specific Access Rights

| Display Name       | Common Name                  | Hex Value     | Interpretation                                                               |
|--------------------|------------------------------|---------------|-------------------------------------------------------------------------------|
| CreateChild        | ADS_RIGHT_DS_CREATE_CHILD    | `0x00000001`  | Create child objects                                                          |
| DeleteChild        | ADS_RIGHT_DS_DELETE_CHILD    | `0x00000002`  | Delete child objects                                                          |
| ListChildren       | ADS_RIGHT_ACTRL_DS_LIST      | `0x00000004`  | List children of container                                                    |
| ValidatedWrite     | ADS_RIGHT_DS_SELF            | `0x00000008`  | Validated write (e.g., SPNs, group membership)                                |
| ReadProperty       | ADS_RIGHT_DS_READ_PROP       | `0x00000010`  | Read object properties                                                        |
| WriteProperty      | ADS_RIGHT_DS_WRITE_PROP      | `0x00000020`  | Modify object properties                                                      |
| DeleteTree         | ADS_RIGHT_DS_DELETE_TREE     | `0x00000040`  | Delete object and all child objects                                           |
| ListObject         | ADS_RIGHT_DS_LIST_OBJECT     | `0x00000080`  | Enumerate specific object                                                     |
| ControlAccess      | ADS_RIGHT_DS_CONTROL_ACCESS  | `0x00000100`  | Perform extended rights (e.g., DCSync, reset password)                        |

---

## üéØ Abusable Extended & Validated Rights

| Display Name                     | Right Name                        | GUID                                     | What It Allows                                                              |
|----------------------------------|-----------------------------------|------------------------------------------|------------------------------------------------------------------------------|
| Reset Password                   | User-Force-Change-Password        | `00299570-246d-11d0-a768-00aa006e0529`   | Reset user's password without knowing the old one                          |
| Replicate Directory Changes      | DS-Replication-Get-Changes        | `1131f6aa-9c07-11d1-f79f-00c04fc2dcd2`   | Needed for DCSync (pull user data)                                         |
| Replicate Directory Changes All  | DS-Replication-Get-Changes-All    | `1131f6ad-9c07-11d1-f79f-00c04fc2dcd2`   | Needed for DCSync (pull **secrets**)                                       |
| Add/Remove Self as Member        | Self-Membership                   | `bf9679c0-0de6-11d0-a285-00aa003049e2`   | Add self to groups, privilege escalation                                   |
| Validated Write to SPN          | Validated-SPN                     | `f3a64788-5306-11d1-a9c5-0000f80367c1`   | Edit SPNs ‚Üí used in **Kerberoasting** attacks                              |


### DACLs Abuses Mindmap

This Map tells what abuses can be carried out depending on a controlled principal's access rights over a specific type of object.

[DACL abuse | The Hacker Recipes](https://www.thehacker.recipes/ad/movement/dacl/#abuse)

