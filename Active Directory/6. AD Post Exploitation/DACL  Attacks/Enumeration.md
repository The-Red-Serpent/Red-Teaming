### Manual Enumeration
### dsacls
<p align="justify">dsacls.exe is a **command-line tool** used to **view and edit permissions** (DACLs) on **Active Directory objects**. It shows you the **Access Control Entries (ACEs)** assigned to users and groups</p>
### Accesschk
<p align="justify">**AccessChk** is a command-line tool from Microsoft’s **Sysinternals Suite** used to **view the effective permissions** (access rights) a user or group has on **files, folders, registry keys, services, processes, or Active Directory objects**.</p>

### Automated Enumeration
- dacledit.py, Bloodhound for linux  used for ACL Enumeration
- Powerview for Windows


### Add Member Rights
<p align="justify">When an attacker controls a privileged user account with the ability to edit a group's member attribute, they can effectively add new users to that group. This attack/abuse is possible when the controlled account has GenericAll , GenericWrite , Self , AllExtendedRights , or Self-Membership over the target group.</p>

##### Abusing AddMember from Linux
we can use the (net) tool,it's used mainly to interact with Windows networks (SMB/CIFS) a built-in utility that allows administrators to manage samba and CIFS/SMB clients. However, it does not work with the Self-Membership access right because remote calls to the net uses the SMB protocol and RPC protocol to perform group modification.

	Another tool : AddusertoGroup.py


### Password Abuse

#### Force Change Password
User-Force-Change-Password is an extended access right that allows users to reset the passwords of other accounts, even those with higher privileges. This is only possible if the controlled account has certain access rights, such as :
- GenericAll  
- AllExtendedRights 
- User Force-Change-Password 
over the target account. These access rights allow the controlled account to modify the target account's password without requiring additional authentication or authorization

Tools used : 
- net
- [pth-toolkit](https://github.com/byt3bl33d3r/pth-toolkit)
- rpcclient

#### ReadLAPSPassword
Local Administrator Password Solution id allowed by Companies instead of having a shared password between local admins (which happens all the time), LAPS offers a simple method to make local admins with random and cryptographically strong passwords that rotate every 30 days

- A LAPS client is installed on each computer. This client is responsible for periodically changing the local administrator password on the computer.
- The password is stored in Active Directory as an attribute of the computer object. This attribute is named ms-MCS-AdmPwd .
##### Conditions
- ReadLAPSPassword
- GenericAll
- AllExtendedRights

If an account has the ReadProperty access right over the attribute ms-MCS-AdmPwd and if ms-MCS AdmPwdExpirationTime is set. This edge helps us to identify potential attack paths by revealing accounts that can read the LAPS password attribute

- Tools: LAPSDumper
Used to Dump the admins passwords

#### ReadGMSAPassword
- **Group Managed Service Accounts (gMSAs)** are special service accounts in Active Directory where **the domain automatically manages their passwords** — rotating them periodically and storing them securely.
    
- Certain users, computers, or groups are given permissions to **read the current password of a gMSA** via the `ReadGMSAPassword` permission.
    
- If an attacker compromises a principal (like a user or machine account) that has this permission, they can extract the password of the gMSA and potentially **impersonate services** that use it. or GMSA Account password

Tools :gMSADumper.py


### Write DACL
`WriteDacl` access right refers to the privilege that allows an account to modify the DACL of a target object. If we possess an account with privileges to modify a target object's ownership or DACL through the WriteDacl access rights. In that case, we can use that account to edit the target's DACL and make it vulnerable to other attacks. Ex : DCSYNC

- If we encounter some other objects such as a group or a user with write DACL Right, we can assign Full Control over the object and abuse these access rights accordingly. We can add a user to this group
- If we want to revert the DACL modification, we can use the backup file generated by dacledit.py

Tools : dacledit.py, addusertogroup.py

### Write Owner or Ownership
- Ownership on the other hand denotes the state of possessing administrative control over an object
- This Ownership right allows us to modify the owner of the target object
- If we have `WriteOwner` over a user we can assign all rights to another account (which will allow us to perform a Password Reset or targeted Kerberoasting )
- if it is a group we can add or remove members, and if it is a GPO we can modify it and do the password reset.
Tools : owneredit.py, dacledit.py


