
## DNS
On Cisco routers, DNS can be configured for two purposes:
✅ **Act as a DNS Client** (Resolve domain names to IPs).  
✅ **Act as a DNS Server** (Provide name resolution for internal hosts).

### 1.Configuring  Router as a DNS Client
This allows the router to resolve domain names into IP addresses using an external DNS server

- Enables DNS resolution on the route
```
ip domain-lookup
```

- Configures external DNS servers
```
ip name-server 8.8.8.8 1.1.1.1
```

- Sets the domain name for local devices.
```
ip domain-name example.com
```

### 2.Configure Router as a DNS Server

A Cisco router can act as a **DNS server** for internal hosts.

- Enables the router’s DNS service
```
ip dns server
```

- Manually maps hostnames to IP addresses
```
ip host <hostname> <IP>
```

- If you don’t want the router to attempt DNS resolution for mistyped commands
```
no ip domain-lookup
```



### 3.Forwarding DNS Queries to External Servers

- If a router is acting as a DNS server but doesn't have an answer for a query, it can **forward the request** to an external DNS server (like Google `8.8.8.8`).
```
 ip dns server              # Enable router as a DNS server
 ip dns forwarding          # Enable DNS forwarding
 ip name-server 8.8.8.8     # Set external DNS server
```

### 4.Conditional DNS Forwarding
- The router can forward **specific domain queries** to different DNS servers. This is useful for split-DNS setups (e.g., sending `example.local` queries to an internal DNS server and all others to a public DNS).
```
 ip dns server              # Enable router as DNS server
 ip dns forwarding          # Enable forwarding
 ip host internal.local 192.168.1.100
 ip name-server 8.8.8.8
```
**How it Works:**

- If a user requests `internal.local`, the router forwards it to `192.168.1.100`.
    
- If any other domain is requested, the router queries `8.8.8.8`.


### 5.Enabling DNS Cache for Faster Resolution
- The router can **cache DNS queries** to reduce latency for repeated queries.
```
 ip dns server
 ip dns cache enable
```
## **Verifying DNS Configuration**

|**Command**|**Description**|
|---|---|
|`show hosts`|Displays DNS-resolved hostnames.|
|`show ip dns view`|Shows DNS server configuration.|
|`nslookup pc1.local`|Queries DNS for a specific hostname.|

## **Viewing DNS Logs & Debugging**

If DNS is not working, check logs using:
```
show hosts                # Show cached DNS resolutions
show ip dns server         # Verify DNS server configuration
debug ip dns               # Enable DNS debugging
undebug all                # Disable debugging (when done)
```

## **Summary**

| **Task**                    | **Command**                      |
| --------------------------- | -------------------------------- |
| Enable DNS Client           | `ip domain-lookup`               |
| Set External DNS Servers    | `ip name-server 8.8.8.8 1.1.1.1` |
| Set Local Domain            | `ip domain-name example.com`     |
| Enable Router as DNS Server | `ip dns server`                  |
| Manually Add Host Entries   | `ip host <hostname> <IP>`        |
| Configure DHCP Clients' DNS | `dns-server 8.8.8.8`             |
| Disable DNS Lookup          | `no ip domain-lookup`            |
